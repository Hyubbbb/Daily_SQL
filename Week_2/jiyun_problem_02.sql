WITH DOCTOR AS (
    SELECT NAME, ROW_NUMBER() OVER () AS rownum FROM OCCUPATIONS WHERE OCCUPATION = 'DOCTOR'
    ORDER BY NAME),
PROFESSOR AS (
    SELECT NAME, ROW_NUMBER() OVER () AS rownum FROM OCCUPATIONS WHERE OCCUPATION = 'PROFESSOR'
    ORDER BY NAME),
SINGER AS (
    SELECT NAME, ROW_NUMBER() OVER () AS rownum FROM OCCUPATIONS WHERE OCCUPATION = 'SINGER'
    ORDER BY NAME),
ACTOR AS (
    SELECT NAME, ROW_NUMBER() OVER () AS rownum FROM OCCUPATIONS WHERE OCCUPATION = 'ACTOR'
    ORDER BY NAME),

DOCTOR_PROFESSOR AS 
(SELECT A.NAME AS DOC_NAME, B.NAME AS PRO_NAME, ROW_NUMBER() OVER () AS rownum FROM DOCTOR A
    LEFT JOIN PROFESSOR B ON A.rownum = B.rownum
UNION
SELECT A.NAME AS DOC_NAME, B.NAME AS PRO_NAME, ROW_NUMBER() OVER () AS rownum FROM DOCTOR A
    RIGHT JOIN PROFESSOR B ON A.rownum = B.rownum),

SINGER_ACTOR AS 
(SELECT C.NAME AS SIN_NAME, D.NAME AS ACT_NAME, ROW_NUMBER() OVER () AS rownum FROM SINGER C
LEFT JOIN ACTOR D ON C.rownum = D.rownum
UNION
SELECT C.NAME AS SIN_NAME, D.NAME AS ACT_NAME, ROW_NUMBER() OVER () AS rownum FROM SINGER C
RIGHT JOIN ACTOR D ON C.rownum = D.rownum)

SELECT DOC_NAME, PRO_NAME, SIN_NAME, ACT_NAME
FROM DOCTOR_PROFESSOR DP
LEFT JOIN SINGER_ACTOR SA ON DP.rownum = SA.rownum

UNION

SELECT DOC_NAME, PRO_NAME, SIN_NAME, ACT_NAME
FROM DOCTOR_PROFESSOR DP
RIGHT JOIN SINGER_ACTOR SA ON DP.rownum = SA.rownum
