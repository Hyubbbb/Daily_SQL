-- [PROGRAMMERS] GROUP BY > 분기별 분화된 대장균의 개체 수 구하기

WITH QUARTER_DATA AS (
    SELECT ID, CASE WHEN MONTH(DIFFERENTIATION_DATE) <= 3 THEN '1Q'
                    WHEN MONTH(DIFFERENTIATION_DATE) <= 6 THEN '2Q'
                    WHEN MONTH(DIFFERENTIATION_DATE) <= 9 THEN '3Q'
               ELSE '4Q'
               END QUARTER
    FROM ECOLI_DATA)

SELECT q.QUARTER, COUNT(e.ID) ECOLI_COUNT
FROM ECOLI_DATA e, QUARTER_DATA q
WHERE e.ID = q.ID
GROUP BY q.QUARTER
ORDER BY 1;
