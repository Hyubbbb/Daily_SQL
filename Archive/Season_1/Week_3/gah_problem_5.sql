-- [PROGRAMERS] JOIN > 오랜 기간 보호한 동물(1)

-- JOIN 사용 X
SELECT NAME, DATETIME
FROM ANIMAL_INS i
WHERE i.ANIMAL_ID NOT IN (SELECT o.ANIMAL_ID
                          FROM ANIMAL_OUTS o)
ORDER BY DATETIME
LIMIT 3;

-- OUTER JOIN 사용
SELECT i.NAME, i.DATETIME
FROM ANIMAL_INS i LEFT JOIN ANIMAL_OUTS o
  ON i.ANIMAL_ID = o.ANIMAL_ID
WHERE o.DATETIME IS NULL
ORDER BY 2
LIMIT 3;

-- INNER JOIN 사용 (비효율)
SELECT NAME, DATETIME
FROM ANIMAL_INS
WHERE ANIMAL_ID NOT IN (SELECT i.ANIMAL_ID
                        FROM ANIMAL_INS i JOIN ANIMAL_OUTS o
                          ON i.ANIMAL_ID = o.ANIMAL_ID)
ORDER BY 2
LIMIT 3;
