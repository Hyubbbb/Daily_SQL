-- 프로그래머스 오프라인/온라인 판매 데이터 통합하기
-- https://school.programmers.co.kr/learn/courses/30/lessons/131537

SELECT DATE_FORMAT(S.SALES_DATE, "%Y-%m-%d") AS SALES_DATE, 
    S.PRODUCT_ID, S.USER_ID, S.SALES_AMOUNT
FROM (
    -- OFFLINE_SALE의 USER_ID는 NULL로 표시
    SELECT OFFLINE_SALE_ID, NULL AS USER_ID, PRODUCT_ID, SALES_AMOUNT, SALES_DATE
    FROM OFFLINE_SALE
    # OFFLINE_SALE과 ONLINE_SALE 테이블 UNION ALL
    UNION ALL
    SELECT * 
    FROM ONLINE_SALE
) AS S
WHERE MONTH(S.SALES_DATE) = 3
ORDER BY S.SALES_DATE, S.PRODUCT_ID, S.USER_ID
