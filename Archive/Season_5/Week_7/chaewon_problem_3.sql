-- 특정 날짜(2022-10-16)에 각 자동차의 대여 가능 여부 확인
SELECT 
    DISTINCT CAR_ID,
    CASE 
        WHEN EXISTS (
            SELECT 1 
            FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY R2
            WHERE R2.CAR_ID = CAR_RENTAL_COMPANY_RENTAL_HISTORY.CAR_ID
              AND '2022-10-16' BETWEEN R2.START_DATE AND R2.END_DATE
        ) THEN '대여중'
        ELSE '대여 가능'
    END AS 'AVAILABILITY'
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
ORDER BY CAR_ID DESC;