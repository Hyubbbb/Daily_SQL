-- SUM, MAX, MIN: 물고기 종류 별 대어 찾기
-- https://school.programmers.co.kr/learn/courses/30/lessons/293261

SELECT FI.ID, FN.FISH_NAME, FI.LENGTH
FROM FISH_INFO FI
JOIN FISH_NAME_INFO FN ON FI.FISH_TYPE = FN.FISH_TYPE
JOIN (
    SELECT FISH_TYPE, MAX(LENGTH) AS MAX_LENGTH
    FROM FISH_INFO
    GROUP BY FISH_TYPE
) MAX_FI ON FI.FISH_TYPE = MAX_FI.FISH_TYPE AND FI.LENGTH = MAX_FI.MAX_LENGTH
ORDER BY FI.ID;
