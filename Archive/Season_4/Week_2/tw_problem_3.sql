-- 1차 그룹화: 저자별 (with 저자명)
-- 2차 그룹화: 카테고리별 -> "매출액"
-- (PRICE*SALES) AS "TOTAL_SALES"

WITH sales AS (SELECT AUTHOR_ID, CATEGORY, SUM(PRICE*SALES) AS "TOTAL_SALES"
FROM BOOK b RIGHT JOIN BOOK_SALES s ON  b.BOOK_ID=s.BOOK_ID
WHERE YEAR(SALES_DATE)=2022 AND MONTH(SALES_DATE)=1
GROUP BY AUTHOR_ID, CATEGORY
               )
-- SELECT *
-- FROM sales

SELECT a.AUTHOR_ID, AUTHOR_NAME, CATEGORY, TOTAL_SALES
FROM sales s JOIN AUTHOR a ON s.AUTHOR_ID=a.AUTHOR_ID
ORDER BY a.AUTHOR_ID, CATEGORY DESC
