-- [PROGRAMMERS] GROUP BY > 입양 시각 구하기(2)

WITH RECURSIVE TIME AS (
    SELECT 0 HOUR
    UNION ALL
    SELECT HOUR + 1
    FROM TIME
    WHERE HOUR < 23)
    
SELECT t.HOUR HOUR, COUNT(o.DATETIME) COUNT
FROM TIME t
     LEFT JOIN ANIMAL_OUTS o
     ON t.HOUR = HOUR(o.DATETIME)
GROUP BY t.HOUR
ORDER BY 1
