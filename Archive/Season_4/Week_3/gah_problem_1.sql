-- [PROGRAMMERS] GROUP BY > 년, 월, 성별 별 상품 구매 회원 수 구하기

SELECT YEAR(s.SALES_DATE) YEAR,
       MONTH(s.SALES_DATE) MONTH,
       u.GENDER,
       COUNT(DISTINCT s.USER_ID)
FROM USER_INFO u JOIN ONLINE_SALE s
     ON u.USER_ID = s.USER_ID
WHERE u.GENDER IS NOT NULL
GROUP BY YEAR, MONTH, GENDER
ORDER BY YEAR, MONTH, GENDER
