-- 10cm이하는 어차피 Null처리 되어있음 -> IS NULL 활용

WITH new AS(
SELECT FISH_TYPE,
CASE
    WHEN LENGTH IS NULL THEN 10
    ELSE LENGTH END AS NEW_LENGTH
FROM FISH_INFO
)


SELECT COUNT(*) AS 'FISH_COUNT', MAX(NEW_LENGTH) AS 'MAX_LENGTH', FISH_TYPE
FROM new
GROUP BY FISH_TYPE
HAVING AVG(NEW_LENGTH) > 33
ORDER BY FISH_TYPE
