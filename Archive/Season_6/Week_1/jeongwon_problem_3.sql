-- 언어별 개발자 분류하기
-- https://school.programmers.co.kr/learn/courses/30/lessons/276036

WITH SKILL AS (
    SELECT 
        MAX(CASE WHEN NAME = 'Python' THEN CODE END) AS PYTHON,
        MAX(CASE WHEN NAME = 'C#' THEN CODE END) AS C_SHARP,
        SUM(CASE WHEN CATEGORY = 'Front End' THEN CODE ELSE 0 END) AS FRONT_END
    FROM SKILLCODES
)

SELECT
    CASE 
        WHEN D.SKILL_CODE & S.FRONT_END > 0 AND D.SKILL_CODE & S.PYTHON > 0 THEN 'A'
        WHEN D.SKILL_CODE & S.C_SHARP > 0 THEN 'B'
        WHEN D.SKILL_CODE & S.FRONT_END > 0 THEN 'C'
    END AS GRADE,
    D.ID,
    D.EMAIL
FROM DEVELOPERS D, SKILL S
WHERE
    (D.SKILL_CODE & S.FRONT_END > 0 AND D.SKILL_CODE & S.PYTHON > 0)
    OR (D.SKILL_CODE & S.C_SHARP > 0)
    OR (D.SKILL_CODE & S.FRONT_END > 0)
ORDER BY GRADE, D.ID;
