-- https://school.programmers.co.kr/learn/courses/30/lessons/284527
SELECT SUM(SCORE) AS SCORE, E.EMP_NO, E.EMP_NAME, POSITION, EMAIL
FROM HR_EMPLOYEES E
LEFT JOIN HR_GRADE G ON E.EMP_NO = G.EMP_NO
LEFT JOIN HR_DEPARTMENT D ON E.DEPT_ID = D.DEPT_ID
GROUP BY EMP_NO
HAVING SCORE = (SELECT MAX(TOTAL_SCORE)
                FROM (SELECT SUM(SCORE) AS TOTAL_SCORE
               FROM HR_GRADE
               GROUP BY EMP_NO, YEAR) AS SCORE)