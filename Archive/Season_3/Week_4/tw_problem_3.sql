-- WITH RECURSIVE 구문 실제 활용 처음
-- 이 외에도 WITH절은 복잡한 쿼리에서 활용성이 좋으니, 점차 익숙해지자

WITH RECURSIVE CTE AS (
    SELECT 0 AS NUM # 초기값 설정
    UNION ALL
    SELECT NUM+1 FROM CTE
    WHERE NUM < 23 # 반복을 멈추는 조건
)

SELECT NUM AS HOUR, COUNT(ANIMAL_ID) AS COUNT
FROM ANIMAL_OUTS a RIGHT JOIN CTE c ON HOUR(DATETIME) = NUM
GROUP BY NUM
ORDER BY NUM
