SELECT A.X AS X,
       A.Y AS Y
FROM FUNCTIONS A
JOIN FUNCTIONS B 
    ON A.X = B.Y
    AND A.Y = B.X
WHERE A.X < A.Y 

UNION

SELECT X, Y
FROM FUNCTIONS
WHERE X = Y
GROUP BY X, Y 
    HAVING COUNT(*) > 1

ORDER BY X;
